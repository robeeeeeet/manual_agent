# Phase 0-1 検証レポート: 画像からのメーカー・型番読み取り

**作成日**: 2024-12-31
**ステータス**: ✅ Go（実装可能）

---

## 1. 検証目的

家電製品の写真から、AIがメーカー名と型番を正確に読み取れるかを検証する。

---

## 2. 検証環境

| 項目 | 内容 |
|------|------|
| AI API | Google Gemini API |
| モデル | gemini-2.0-flash-exp（メイン）|
| 画像形式 | HEIC（iPhone撮影） |
| テスト画像数 | 6枚 |

---

## 3. テスト画像

| ファイル名 | 製品カテゴリ | 写真タイプ |
|------------|--------------|------------|
| IMG_1783.HEIC | 電子レンジ | ラベル写真 |
| IMG_1784.HEIC | オーブンレンジ | ラベル写真 |
| IMG_1785.HEIC | 電気ポット | ラベル写真 |
| IMG_1786.HEIC | 炊飯器 | ラベル写真 |
| IMG_1787.HEIC | オーブントースター | 全体像（ラベルなし） |
| IMG_1788.HEIC | オーブントースター | ラベル写真 |

---

## 4. 検証結果

### 4.1 型番ラベルが見える写真

| 画像 | メーカー | 型番 | 結果 |
|------|----------|------|------|
| IMG_1783 | 日立 | MRO-S7D | ✅ 正確 |
| IMG_1784 | 日立 | MRO-S7D(W) | ✅ 正確 |
| IMG_1785 | 象印 | CP-EA20 | ✅ 正確 |
| IMG_1786 | 象印 | NW-JX10 | ✅ 正確 |
| IMG_1788 | タイガー | KAM-R132 | ✅ 正確 |

**成功率: 5/5（100%）**

### 4.2 型番ラベルが見えない写真

| 画像 | メーカー特定 | 型番 | ラベル位置案内 |
|------|--------------|------|----------------|
| IMG_1787 | ✅ タイガー | ❌ 読み取り不可 | ✅ 提供 |

---

## 5. 発見事項

### 5.1 成功したアプローチ

1. **型番ラベルの直接読み取り**
   - HEIC形式の画像を問題なく処理
   - 日本語・英語混在のラベルも正確に読み取り
   - 高確信度（high）で安定した結果

2. **型番パターンからのメーカー推測**
   - 画像にメーカー名がなくても、型番の命名規則から推測可能
   - 例: `CP-EA20` → 象印（電気ポットのCPシリーズ）

3. **ラベル位置の案内**
   - 全体像のみの写真でも、メーカー・カテゴリを特定
   - 型番ラベルの位置を優先順位付きで提案
   - 撮影のコツも併せて提供

### 5.2 失敗したアプローチ（採用しない）

1. **外観からの型番推測**
   - Gemini 2.5 Pro / 3 Pro で試行
   - 結果: 類似製品の型番を誤って提案
   - 実際: KAM-R132 → 推測: KAE-G13N, KAK-G100（不正解）
   - 原因: LLMの学習データに最新商品が含まれない

---

## 6. 採用する戦略

```
┌─────────────────────────────────────────────────────────┐
│                    画像アップロード                       │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
              ┌───────────────────────┐
              │   Gemini で画像解析    │
              └───────────────────────┘
                          │
            ┌─────────────┴─────────────┐
            ▼                           ▼
   ┌─────────────────┐       ┌─────────────────────┐
   │ 型番が読み取れた │       │ 型番が読み取れない   │
   │ status: success │       │ status: need_label  │
   └─────────────────┘       └─────────────────────┘
            │                           │
            ▼                           ▼
   ┌─────────────────┐       ┌─────────────────────┐
   │ 次のフェーズへ   │       │ ラベル位置を案内     │
   │ (PDF取得)       │       │ → ユーザーが再撮影   │
   └─────────────────┘       └─────────────────────┘
```

### レスポンス形式

**型番読み取り成功時**
```json
{
  "status": "success",
  "manufacturer": {"ja": "タイガー魔法瓶株式会社", "en": "Tiger Corporation"},
  "model_number": "KAM-R132",
  "category": "オーブントースター",
  "confidence": "high"
}
```

**型番読み取り失敗時（撮り直し案内）**
```json
{
  "status": "need_label_photo",
  "manufacturer": {"ja": "タイガー", "en": "Tiger"},
  "model_number": null,
  "category": "オーブントースター",
  "confidence": "medium",
  "label_guide": {
    "locations": [
      {"position": "本体背面", "description": "...", "priority": 1},
      {"position": "本体底面", "description": "...", "priority": 2}
    ],
    "photo_tips": "明るい場所で、ラベル全体がフレームに収まるように..."
  }
}
```

---

## 7. 技術的な注意点

### 7.1 ライブラリの非推奨警告

```
FutureWarning: All support for the `google.generativeai` package has ended.
Please switch to the `google.genai` package.
```

**対応**: 本格実装時に `google-genai` パッケージへ移行が必要

### 7.2 モデル選択

| モデル | 速度 | コスト | 用途 |
|--------|------|--------|------|
| gemini-2.0-flash-exp | 高速 | 低 | ラベル読み取り（推奨） |
| gemini-2.5-pro | 低速 | 高 | 複雑な解析時のみ |

---

## 8. 結論

### Go / No-Go 判定: ✅ Go

| 評価項目 | 結果 |
|----------|------|
| 型番ラベル読み取り精度 | ✅ 100%（5/5） |
| メーカー特定精度 | ✅ 100%（6/6） |
| ラベル位置案内機能 | ✅ 実用的 |
| レスポンス速度 | ✅ 数秒以内 |
| API無料枠での運用 | ✅ 可能（60 QPM） |

### 次のステップ

Phase 0-2「メーカー・型番からマニュアルPDF取得」の検証へ進む

---

## 9. 成果物

| ファイル | 説明 |
|----------|------|
| `scripts/test_image_recognition.py` | 画像認識テストスクリプト（推奨） |
| `archive/test_label_location.py` | ラベル位置案内テスト |
| `archive/test_inference.py` | 型番からメーカー推測テスト |
| `archive/test_image_pro.py` | Pro版モデルテスト |
